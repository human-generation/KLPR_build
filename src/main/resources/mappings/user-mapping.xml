<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UserDAO">
	<resultMap id="userResult" type="user">
		<id property="uno" column="UNO" />
		<result property="email" column="EMAIL" />
		<result property="pw" column="PW" />
		<result property="name" column="NAME" />
		<result property="gender" column="GENDER" />
		<result property="money" column="MONEY" />
		<result property="phone" column="PHONE" />
		<result property="ucomment" column="UCOMMENT" />
	</resultMap>

	<insert id="insertUser">
		INSERT INTO user(UNO, EMAIL, PW, NAME, GENDER, MONEY,
		PHONE, UCOMMENT)
		VALUES((SELECT NVL(max(uno), 0)+1 FROM user),
		#{email}, #{pw}, #{name}, #{gender},
		0, #{phone}, #{ucomment})
	</insert>

	<update id="updateUser">
		UPDATE USER SET PW=#{pw}, PHONE=#{phone},
		ucomment=#{ucomment} WHERE uno=#{uno}
	</update>

	<delete id="deleteUser">
		DELETE USER WHERE uno=#{uno}
	</delete>

	<select id="getUser" resultMap="userResult">
		SELECT * FROM user WHERE
		EMAIL=#{email} AND PW=#{pw}
	</select>

	<select id="getUserList" resultType="user">
		SELECT * FROM USER
		WHERE 1=1
		<if test="searchCondition=='EMAIL'">
			AND EMAIL LIKE '%'||#{searchKeyword}||'%'
		</if>
		<if test="searchCondition=='NAME'">
			AND NAME LIKE '%'||#{searchKeyword}||'%'
		</if>
		ORDER BY uno DESC
	</select>

</mapper>